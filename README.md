# Historical Event Analysis System - å†å²äº‹ä»¶ç¾¤åƒåˆ†æç³»ç»Ÿ

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªé’ˆå¯¹å†å²æ–‡æœ¬ï¼ˆå¦‚ã€Šå²è®°Â·æ±‰é«˜ç¥–æœ¬çºªã€‹ï¼‰è¿›è¡Œå¤šç»´åº¦æ•°æ®åˆ†æä¸å¯è§†åŒ–çš„åç«¯ç³»ç»Ÿã€‚é¡¹ç›®åŸºäº Python Flask æ¡†æ¶ï¼Œæ•´åˆäº†å› æœå…³ç³»æå–ã€äº‹ä»¶ç±»å‹èšç±»ã€åœ°ç‚¹ç©ºé—´åˆ†å¸ƒä»¥åŠæ—¶é—´æ¼”åŒ–åˆ†æç­‰å¤šä¸ªæ¨¡å‹ï¼Œä¸ºå‰ç«¯æä¾›æ•°æ®æ”¯æŒã€å›¾è¡¨èµ„æºåŠé™æ€æ–‡ä»¶æœåŠ¡ã€‚

## ğŸ“š é¡¹ç›®åŠŸèƒ½

æœ¬é¡¹ç›®ä¸»è¦åŒ…å«å››å¤§åˆ†ææ¨¡å—ï¼š

1.  **å› æœå…³ç³»åˆ†æ (Causal Analysis)**
    *   æ„å»ºå†å²äº‹ä»¶å› æœå…³ç³»å›¾è°±ã€‚
    *   åˆ†ææ ¸å¿ƒçš„å‰å› åæœé“¾è·¯ã€‚
    *   æ¥å£ï¼š`/analysis/causal/portrait`

2.  **äº‹ä»¶ç±»å‹åˆ†æ (Event Type Analysis)**
    *   åŸºäº DBSCAN/KMeans å¯¹å†å²äº‹ä»¶è¿›è¡Œèšç±»ã€‚
    *   åˆ†æäº‹ä»¶ç±»å‹çš„åˆ†å¸ƒä¸ç‰¹å¾ã€‚
    *   æ¥å£ï¼š`/analysis/event/type`

3.  **åœ°ç‚¹ç©ºé—´åˆ†æ (Location Analysis)**
    *   åˆ†æå†å²äº‹ä»¶å‘ç”Ÿçš„åœ°ç†ç©ºé—´åˆ†å¸ƒã€‚
    *   å¯¹åœ°ç‚¹è¿›è¡Œèšç±»ä¸è§’è‰²ï¼ˆå‡ºå‘åœ°/ç›®çš„åœ°ï¼‰åˆ†æã€‚
    *   æ¥å£ï¼š`/analysis/event/location`

4.  **æ—¶é—´æ¼”åŒ–åˆ†æ (Time Evolution Analysis)**
    *   è§£æå†å²æ—¶é—´ï¼ˆå¹´å·ã€å­£èŠ‚ç­‰ï¼‰å¹¶æ˜ å°„åˆ°æ ‡å‡†æ—¶é—´è½´ã€‚
    *   åˆ†æäº‹ä»¶åœ¨ä¸åŒæœä»£/æ—¶é—´çª—å£çš„æ¼”åŒ–è§„å¾‹ã€‚
    *   æ¥å£ï¼š`/analysis/event/time`

> **Note**: æ‰€æœ‰æ¥å£å‡æ”¯æŒ **è·¨åŸŸè®¿é—® (CORS)**ï¼Œä¸”åŒæ—¶æ”¯æŒ `GET` å’Œ `POST` è¯·æ±‚æ–¹æ³•ã€‚

## ğŸ“‚ ç›®å½•ç»“æ„

```text
.
â”œâ”€â”€ app.py                      # Flask Web æœåŠ¡ä¸»ç¨‹åº
â”œâ”€â”€ cause_result_model.py       # å› æœå…³ç³»æ¨¡å‹è„šæœ¬
â”œâ”€â”€ event_type_model.py         # äº‹ä»¶ç±»å‹åˆ†æè„šæœ¬
â”œâ”€â”€ location_model.py           # åœ°ç‚¹åˆ†æè„šæœ¬
â”œâ”€â”€ time_relationship_mode2.py  # æ—¶é—´åˆ†æè„šæœ¬
â””â”€â”€ output/                     # [è‡ªåŠ¨ç”Ÿæˆ] åˆ†æç»“æœè¾“å‡ºç›®å½•
    â”œâ”€â”€ image/                  # ç”Ÿæˆçš„åˆ†æå›¾è¡¨ (PNG)
    â”œâ”€â”€ csv/                    # ç”Ÿæˆçš„åˆ†ææ•°æ® (CSV)
    â”œâ”€â”€ causal_relations.json   # å› æœå…³ç³»æ•°æ®æº
    â””â”€â”€ historical_relations/   # å†å²äº‹ä»¶æ•°æ®æº
```

## ğŸ› ï¸ ç¯å¢ƒå‡†å¤‡

è¯·ç¡®ä¿ Python ç‰ˆæœ¬ \>= 3.8ï¼Œå¹¶å®‰è£…ä»¥ä¸‹ä¾èµ–ï¼š

```bash
pip install flask pandas numpy networkx scikit-learn matplotlib seaborn
```

*æ³¨æ„ï¼šæœ¬é¡¹ç›®ä¸º Windows ç¯å¢ƒåšäº†ç‰¹å®šä¼˜åŒ–ï¼Œè§£å†³äº†å¸¸è§çš„ `OMP` å¹¶è¡Œè®¡ç®—è­¦å‘Šã€‚*

## ğŸš€ è¿è¡Œä¸ä½¿ç”¨

### 1. æ•°æ®å‡†å¤‡

è¯·ç¡®ä¿ `output/` ç›®å½•ä¸‹åŒ…å«ä»¥ä¸‹åŸºç¡€æ•°æ®æ–‡ä»¶ï¼ˆç”±ä¸Šæ¸¸ NLP ä»»åŠ¡ç”Ÿæˆï¼‰ï¼š
*   `output/causal_relations.json`
*   `output/historical_relations/EE-Hangaozubenji_updated.json`

### 2. æ‰§è¡Œåˆ†ææ¨¡å‹

åœ¨å¯åŠ¨ API ä¹‹å‰ï¼Œå»ºè®®å…ˆè¿è¡Œå„ä¸ªæ¨¡å‹è„šæœ¬ä»¥ç”Ÿæˆæœ€æ–°çš„å›¾è¡¨å’Œ CSV æ–‡ä»¶ï¼š

```bash
# ä¾æ¬¡è¿è¡Œåˆ†æè„šæœ¬
python cause_result_model.py
python event_type_model.py
python location_model.py
python time_relationship_mode2.py
```

æ‰§è¡Œåï¼Œæ£€æŸ¥ `output/image/` å’Œ `output/csv/` ç›®å½•ï¼Œç¡®è®¤æ–‡ä»¶å·²ç”Ÿæˆã€‚

### 3. å¯åŠ¨ Web æœåŠ¡

```bash
python app.py
```

æœåŠ¡é»˜è®¤ç›‘å¬ç«¯å£ **5006**ã€‚

### 4. API æ¥å£è°ƒç”¨ç¤ºä¾‹

*   **URL**: `http://localhost:5006/analysis/event/type`
*   **Method**: `GET` æˆ– `POST`
*   **Response**:

```json
{
    "code": 200,
    "data": {
        "scatter": [...],   // å‰ç«¯æ¸²æŸ“æ•£ç‚¹å›¾æ‰€éœ€æ•°æ®
        "stats": {...},     // ç»Ÿè®¡æŒ‡æ ‡
        "files": {          // é™æ€èµ„æºé“¾æ¥ï¼ˆæ”¯æŒå‰ç«¯ç›´æ¥å±•ç¤ºæˆ–ä¸‹è½½ï¼‰
            "image": "http://localhost:5006/files/image/event_clusters_output.png",
            "csv": "http://localhost:5006/files/csv/event_category_clusters.csv"
        }
    }
}
```

### 5. é™æ€æ–‡ä»¶è®¿é—®

ç³»ç»Ÿè‡ªåŠ¨æš´éœ² `output` ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ ¼å¼è®¿é—®ï¼š
*   **å›¾ç‰‡**: `http://localhost:5006/files/image/<æ–‡ä»¶å>.png`
*   **CSV**: `http://localhost:5006/files/csv/<æ–‡ä»¶å>.csv`
